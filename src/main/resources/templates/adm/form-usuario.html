<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{adm/layout :: layout(~{::content})}">

<body>
    <div th:fragment="content">
        <th:block th:with="title=${usuario.id == null ? 'Novo Usuário' : 'Editar Usuário'}"></th:block>
        <div class="container" style="max-width: 600px;">
            <div style="margin-bottom: var(--spacing-md);">
                <a th:href="@{/adm/usuarios}"
                    style="color: var(--text-muted); text-decoration: none; font-size: 0.9rem;">&larr; Voltar para a
                    Lista</a>
            </div>

            <div class="feature-card" style="padding: var(--spacing-lg);">
                <h1 class="section-title" style="text-align: left; margin-bottom: var(--spacing-md);"
                    th:text="${usuario.id == null ? 'Cadastrar Novo Usuário' : 'Editar Perfil do Usuário'}">Cadastrar
                    Usuário</h1>

                <div th:if="${error}"
                    style="background-color: #fee2e2; color: #dc2626; padding: 1rem; border-radius: 8px; margin-bottom: var(--spacing-md);">
                    <span th:text="${error}">Erro</span>
                </div>

                <form th:action="${usuario.id == null ? '/adm/usuarios/novo' : '/adm/usuarios/editar/' + usuario.id}"
                    th:object="${usuario}" method="post">
                    <input type="hidden" th:field="*{id}">

                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Nome Completo</label>
                        <input type="text" th:field="*{nome}" required
                            style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 8px; outline: none;">
                    </div>

                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">E-mail (Login)</label>
                        <input type="email" th:field="*{email}" required
                            style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 8px; outline: none;">
                    </div>

                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">Tipo de Usuário</label>
                        <select th:field="*{tipo}" required
                            style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 8px; outline: none; background: white;">
                            <option value="">Selecione...</option>
                            <option th:each="t : ${tipos}" th:value="${t.id}" th:text="${t.nome}">Tipo</option>
                        </select>
                    </div>

                    <div style="margin-bottom: 1.5rem;">
                        <label style="display: block; font-weight: 600; margin-bottom: 0.5rem;">
                            Senha <span th:if="${usuario.id != null}"
                                style="font-weight: 400; font-size: 0.8rem; color: var(--text-muted);">(deixe em branco
                                para não alterar)</span>
                        </label>
                        <input type="password" name="senha" th:required="${usuario.id == null}"
                            style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 8px; outline: none;">
                    </div>

                    <div style="display: flex; gap: var(--spacing-sm); margin-top: var(--spacing-md);">
                        <button type="submit" class="hero-btn-primary"
                            style="flex: 1; border: none; padding: 1rem; cursor: pointer;"
                            th:text="${usuario.id == null ? 'Criar Usuário' : 'Salvar Alterações'}">Salvar</button>
                        <a th:href="@{/adm/usuarios}" class="btn-login"
                            style="padding: 1rem; background: #eee; color: var(--text); text-decoration: none; text-align: center;">Cancelar</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>

</html>