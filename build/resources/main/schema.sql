-- Create usuarios table

CREATE TABLE IF NOT EXISTS tipo_usuario (
    id_tipo_usu BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nm_tipo_usu VARCHAR(20) NOT NULL,
    ds_tipo_usu VARCHAR(255) NOT NULL
);

CREATE TABLE IF NOT EXISTS usuarios (
    id_usuari_usu BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nm_usuari_usu VARCHAR(100) NOT NULL,
    ds_email_usu VARCHAR(100) NOT NULL UNIQUE,
    ds_senha_usu VARCHAR(255) NOT NULL,
    id_tipo_usu BIGINT NOT NULL,
    data_criacao_usuari_usu TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id_tipo_usu) REFERENCES tipo_usuario(id_tipo_usu)
);

CREATE TABLE IF NOT EXISTS enderecos (
    id_endere_end BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    cd_numcep_end VARCHAR(8) NOT NULL,
    nm_lograd_end VARCHAR(100) NOT NULL,
    ds_bairro_end VARCHAR(255) NOT NULL,
    ds_cidade_end VARCHAR(100) NOT NULL,
    ds_estado_end VARCHAR(2) NOT NULL,
    ds_comple_end VARCHAR(255),
    ds_mapurl_end VARCHAR(500)
);

CREATE TABLE IF NOT EXISTS tipo_ponto_coleta (
    id_tipo_pco BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nm_tipo_pco VARCHAR(20) NOT NULL,
    ds_tipo_pco VARCHAR(255) NOT NULL
);

-- Create pontos_coleta table
CREATE TABLE IF NOT EXISTS pontos_coleta (
    id_poncol_pco BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nm_poncol_pco VARCHAR(100) NOT NULL,
    id_endere_end BIGINT NOT NULL,
    id_usuari_usu BIGINT,
    id_tipo_pco BIGINT NOT NULL,
    FOREIGN KEY (id_usuari_usu) REFERENCES usuarios(id_usuari_usu),
    FOREIGN KEY (id_tipo_pco) REFERENCES tipo_ponto_coleta(id_tipo_pco),
    FOREIGN KEY (id_endere_end) REFERENCES enderecos(id_endere_end)
);

-- Create categorias_residuo table
CREATE TABLE IF NOT EXISTS categorias_residuo (
    id_catres_cre BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nm_catres_cre VARCHAR(50) NOT NULL UNIQUE,
    ds_catres_cre VARCHAR(255)
);

CREATE TABLE IF NOT EXISTS situacao_descarte (
    id_situac_desc BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nm_situac_desc VARCHAR(20) NOT NULL,
    ds_situac_desc VARCHAR(255)
);


-- Create descartes table
CREATE TABLE IF NOT EXISTS descartes (
    id_descar_des BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    id_usuari_usu BIGINT NOT NULL,
    id_poncol_pco BIGINT NOT NULL,
    id_catres_cre BIGINT NOT NULL,
    id_situac_desc BIGINT NOT NULL,
    qt_descar_des DECIMAL(10,2), -- em kg ou unidades
    dt_descar_des TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id_usuari_usu) REFERENCES usuarios(id_usuari_usu),
    FOREIGN KEY (id_poncol_pco) REFERENCES pontos_coleta(id_poncol_pco),
    FOREIGN KEY (id_catres_cre) REFERENCES categorias_residuo(id_catres_cre),
    FOREIGN KEY (id_situac_desc) REFERENCES situacao_descarte(id_situac_desc)
);
